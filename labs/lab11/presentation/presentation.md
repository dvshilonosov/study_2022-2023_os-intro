---
## Front matter
lang: ru-RU
title: Лабораторная работа №11
subtitle: Курс "Операционные Системы"
author:
  - Шилоносов Д.В., НКАбд-03-22
institute:
  - Российский университет дружбы народов, Москва, Россия
  
date: 22 апреля 2023

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Шилоносов Данил Вячеславович
  * студент группы НКАбд-03-22
  * кафедры Компьютерные и информационные науки 
  * Российский университет дружбы народов
  * [1132221810@pfur.ru](mailto:1132221810@pfur.ru)
  

:::
::: {.column width="30%"}


:::
::::::::::::::

## Цель работы
Изучить основы программирования в оболочке ОС UNIX. Научится писать более сложные командные файлы с использованием логических управляющих конструкций и циклов.

## Задачи
1. Используя команды getopts grep, написать командный файл, который анализирует командную строку с ключами:
- -iinputfile — прочитать данные из указанного файла;
- -ooutputfile — вывести данные в указанный файл;
- -pшаблон — указать шаблон для поиска;
- -C — различать большие и малые буквы;
- -n — выдавать номера строк.
а затем ищет в указанном файле нужные строки, определяемые ключом -p.

2. Написать на языке Си программу, которая вводит число и определяет, является ли оно больше нуля, меньше нуля или равно нулю. Затем программа завершается с помощью функции exit(n), передавая информацию в о коде завершения в оболочку. Командный файл должен вызывать эту программу и, проанализировав с помощью команды $?, выдать сообщение о том, какое число было введено.

## Задачи
3. Написать командный файл, создающий указанное число файлов, пронумерованных последовательно от 1 до N (например 1.tmp, 2.tmp, 3.tmp,4.tmp и т.д.). Число файлов, которые необходимо создать, передаётся в аргументы командной строки. Этот же командный файл должен уметь удалять все созданные им файлы (если они существуют).

4. Написать командный файл, который с помощью команды tar запаковывает в архив все файлы в указанной директории. Модифицировать его так, чтобы запаковывались только те файлы, которые были изменены менее недели тому назад (использовать команду find).

   
# Выполнение лабораторной работы
## Исходный код скрипта №1

![](image/1.png){#fig:001 width=100%}

## Описание скрипта №1
Данный командный файл на Bash обрабатывает параметры командной строки и выполняет поиск строк в указанном файле на основе заданного шаблона. Он поддерживает следующие параметры:
- -i inputfile - указывает входной файл для чтения данных.
- -o outputfile - указывает выходной файл для записи результатов.
- -p pattern - указывает шаблон для поиска в файле.
- -C - различает большие и малые буквы при поиске.
- -n - выводит номера строк, в которых найден заданный шаблон.

Если параметр -p не указан, скрипт выведет сообщение об ошибке и завершится. Если входной файл не существует, скрипт также выведет сообщение об ошибке и завершится.

После обработки параметров, скрипт настраивает опции для команды grep, используя флаги -i (если -C указан) и -n (если -n указан). Затем скрипт выполняет поиск заданного шаблона в указанном файле, используя команду grep. Результаты выводятся в консоль или в указанный выходной файл в зависимости от того, указан ли параметр -o.

## Результат выполнения скрипта №1

![](image/2.png){#fig:002 width=100%}


## Исходный код скрипта №2

![](image/3.png){#fig:001 width=100%}

## Описание скрипта №2
Этот скрипт запрашивает у пользователя ввод числа, запускает программу на языке C, передает ей введенное число в качестве аргумента, а затем выводит сообщение в зависимости от кода завершения программы.
Затем скрипт выводит на экран приглашение для ввода числа. Когда пользователь вводит число, оно сохраняется в переменной number.

Далее скрипт вызывает программу на языке C и передает ей введенное число в качестве аргумента.

После того, как программа завершилась, скрипт проверяет код завершения программы с помощью команды $? и выводит соответствующее сообщение, основываясь на коде завершения. Если код завершения равен 0, то выводится сообщение "Вы ввели число, равное нулю.", если код завершения равен 1, то выводится сообщение "Вы ввели число, большее нуля.", а если код завершения равен 2, то выводится сообщение "Вы ввели число, меньшее нуля."

## Результат выполнения скрипта №2

![](image/4.png){#fig:002 width=100%}


## Исходный код скрипта №3

![](image/5.png){#fig:001 width=100%}

## Описание скрипта №3
Сначала проверяется, был ли передан путь к каталогу в качестве аргумента командной строки, используя проверку на пустоту переменной "$1". Если переменная пуста, то выводится сообщение об использовании скрипта и завершается его выполнение с кодом ошибки 1.

Затем проверяется, существует ли указанный каталог, используя проверку с помощью команды "[ ! -d "$1" ]". Если каталог не существует, то выводится сообщение об ошибке и скрипт завершается с кодом ошибки 1.

## Описание скрипта №3
Данный скрипт - это командный файл для создания и удаления последовательности файлов с пронумерованными именами от 1 до N. Количество файлов, которые нужно создать, передается в качестве аргумента командной строки. Скрипт проверяет, что передан только один аргумент, затем создает файлы в цикле и выводит сообщение о количестве созданных файлов. После этого скрипт ждет от пользователя ввода любой клавиши и затем удаляет созданные файлы в цикле, снова выводя сообщение о количестве удаленных файлов.

## Результат выполнения скрипта №3

![](image/6.png){#fig:002 width=100%}


## Исходный код скрипта №4

![](image/7.png){#fig:001 width=100%}

## Описание скрипта №4
Этот скрипт - это командный файл для создания архива из файлов, находящихся в указанной директории, которые были изменены менее недели тому назад. Он принимает путь к директории в качестве аргумента при запуске и использует команду find для поиска файлов, отвечающих указанному условию. Затем найденные файлы передаются в tar, который создает сжатый архив. Если при запуске скрипта не был передан путь к директории или указанный путь не является действительным каталогом, скрипт выдает сообщение об ошибке и завершает работу с кодом ошибки 1. По завершении работы, скрипт выводит сообщение об успешном завершении и устанавливает код возврата 0.

## Результат выполнения скрипта №4

![](image/8.png){#fig:002 width=100%}

# Результаты

## Выводы
Были получены навыки написания более сложных командных файлов с использованием логических управляющих конструкций и циклов.
